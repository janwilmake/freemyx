<!DOCTYPE html>
<html lang="en" class="bg-black">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Example App - Data Liberation Check</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: "Inter", sans-serif;
        }

        .liberation-gradient {
            background: linear-gradient(135deg, #000000 0%, #1a1a2e 50%, #16213e 100%);
        }

        .free-border {
            border: 1px solid rgba(34, 197, 94, 0.3);
        }

        .button-glow:hover {
            box-shadow: 0 0 30px rgba(34, 197, 94, 0.6);
        }

        .pulse-green {
            animation: pulse-green 2s infinite;
        }

        @keyframes pulse-green {

            0%,
            100% {
                opacity: 1;
            }

            50% {
                opacity: 0.5;
            }
        }
    </style>
</head>

<body class="text-white liberation-gradient min-h-screen">
    <div class="max-w-2xl mx-auto px-4 py-16">
        <!-- Header -->
        <div class="text-center mb-12">
            <h1 class="text-4xl font-bold mb-4">üöÄ Example App</h1>
            <p class="text-xl text-gray-400">Powered by liberated X data</p>
            <div class="mt-4 text-sm text-green-400">
                <span class="inline-flex items-center gap-2">
                    <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd"
                            d="M2.166 4.999A11.954 11.954 0 0010 1.944 11.954 11.954 0 0017.834 5c.11.65.166 1.32.166 2.001 0 5.225-3.34 9.67-8 11.317C5.34 16.67 2 12.225 2 7c0-.682.057-1.35.166-2.001zm11.541 3.708a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z"
                            clip-rule="evenodd" />
                    </svg>
                    Respects your data liberation choices
                </span>
            </div>
        </div>

        <!-- Step 1: Username Input -->
        <div class="free-border rounded-xl p-8 mb-6">
            <div class="flex items-center gap-3 mb-6">
                <div class="w-8 h-8 bg-blue-600 rounded-full flex items-center justify-center font-bold">1</div>
                <h2 class="text-2xl font-bold">Enter Your X Username</h2>
            </div>

            <div class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-300 mb-2">X Username (without @)</label>
                    <div class="flex gap-3">
                        <input type="text" id="username" placeholder="your_username"
                            class="flex-1 bg-gray-800/50 border border-gray-600 rounded-lg px-4 py-3 text-white placeholder-gray-400 focus:border-green-500 focus:outline-none">
                        <button onclick="checkLiberation()"
                            class="bg-green-600 hover:bg-green-700 px-6 py-3 rounded-lg font-bold transition-all button-glow">
                            Check Status
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Step 2: Liberation Status -->
        <div id="statusSection" class="hidden">
            <div class="free-border rounded-xl p-8 mb-6">
                <div class="flex items-center gap-3 mb-6">
                    <div class="w-8 h-8 bg-blue-600 rounded-full flex items-center justify-center font-bold">2</div>
                    <h2 class="text-2xl font-bold">Data Liberation Status</h2>
                </div>

                <!-- Liberation Success -->
                <div id="liberatedStatus" class="hidden">
                    <div class="bg-green-500/10 border border-green-500/30 rounded-lg p-6 mb-4">
                        <div class="flex items-center gap-3 mb-3">
                            <div class="w-8 h-8 bg-green-500 rounded-full flex items-center justify-center">
                                <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                    <path fill-rule="evenodd"
                                        d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z"
                                        clip-rule="evenodd" />
                                </svg>
                            </div>
                            <div>
                                <h3 class="text-xl font-bold text-green-400">‚úÖ Data Liberated!</h3>
                                <p class="text-gray-300">You can proceed with the app setup</p>
                            </div>
                        </div>

                        <div id="userInfo" class="bg-green-900/20 rounded-lg p-4 mb-4">
                            <!-- User info will be populated here -->
                        </div>

                        <button onclick="proceedToNextStep()"
                            class="bg-green-600 hover:bg-green-700 px-8 py-3 rounded-full font-bold transition-all button-glow pulse-green">
                            Continue Setup ‚Üí
                        </button>
                    </div>
                </div>

                <!-- Liberation Required -->
                <div id="notLiberatedStatus" class="hidden">
                    <div class="bg-red-500/10 border border-red-500/30 rounded-lg p-6 mb-4">
                        <div class="flex items-center gap-3 mb-3">
                            <div class="w-8 h-8 bg-red-500 rounded-full flex items-center justify-center">
                                <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                    <path fill-rule="evenodd"
                                        d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z"
                                        clip-rule="evenodd" />
                                </svg>
                            </div>
                            <div>
                                <h3 class="text-xl font-bold text-red-400">‚ùå Data Not Liberated</h3>
                                <p class="text-gray-300">You need to liberate your X data first</p>
                            </div>
                        </div>

                        <div class="bg-red-900/20 rounded-lg p-4 mb-4">
                            <h4 class="font-bold text-red-300 mb-2">What does this mean?</h4>
                            <ul class="text-sm text-red-200 space-y-1">
                                <li>‚Ä¢ You haven't authorized third-party access to your X data</li>
                                <li>‚Ä¢ You need to vote for data liberation with at least "Me" access</li>
                                <li>‚Ä¢ This ensures you consent to data sharing for app functionality</li>
                            </ul>
                        </div>

                        <div class="flex flex-col sm:flex-row gap-3">
                            <a href="https://freemyx.com" target="_blank"
                                class="bg-green-600 hover:bg-green-700 px-6 py-3 rounded-full font-bold transition-all button-glow text-center">
                                üîì Liberate Your Data First
                            </a>
                            <button onclick="recheckStatus()"
                                class="bg-blue-600 hover:bg-blue-700 px-6 py-3 rounded-full font-bold transition-all text-center">
                                ‚Üª Re-check Status
                            </button>
                        </div>
                    </div>
                </div>

                <!-- User Not Found -->
                <div id="userNotFound" class="hidden">
                    <div class="bg-yellow-500/10 border border-yellow-500/30 rounded-lg p-6">
                        <div class="flex items-center gap-3 mb-3">
                            <div class="w-8 h-8 bg-yellow-500 rounded-full flex items-center justify-center">
                                <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                    <path fill-rule="evenodd"
                                        d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z"
                                        clip-rule="evenodd" />
                                </svg>
                            </div>
                            <div>
                                <h3 class="text-xl font-bold text-yellow-400">‚ö†Ô∏è Username Not Found</h3>
                                <p class="text-gray-300">This user hasn't interacted with Free My X yet</p>
                            </div>
                        </div>

                        <div class="bg-yellow-900/20 rounded-lg p-4 mb-4">
                            <p class="text-sm text-yellow-200">
                                The username might be incorrect, or the user hasn't visited freemyx.com to authorize
                                data liberation.
                            </p>
                        </div>

                        <div class="flex flex-col sm:flex-row gap-3">
                            <a href="https://freemyx.com" target="_blank"
                                class="bg-green-600 hover:bg-green-700 px-6 py-3 rounded-full font-bold transition-all button-glow text-center">
                                üîì Get Started with Free My X
                            </a>
                            <button onclick="resetForm()"
                                class="bg-gray-600 hover:bg-gray-700 px-6 py-3 rounded-full font-bold transition-all text-center">
                                ‚Üê Try Different Username
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Step 3: Continue Onboarding -->
        <div id="onboardingSection" class="hidden">
            <div class="free-border rounded-xl p-8">
                <div class="flex items-center gap-3 mb-6">
                    <div class="w-8 h-8 bg-blue-600 rounded-full flex items-center justify-center font-bold">3</div>
                    <h2 class="text-2xl font-bold">Continue App Setup</h2>
                </div>

                <div class="bg-gray-800/50 rounded-lg p-6">
                    <h3 class="text-xl font-bold mb-4">üéâ Welcome to the App!</h3>
                    <p class="text-gray-300 mb-4">
                        Great! Your data is liberated and we can proceed with the full onboarding experience.
                    </p>

                    <div class="space-y-3 text-sm text-gray-400">
                        <p>‚Ä¢ Configure your preferences</p>
                        <p>‚Ä¢ Set up data analysis parameters</p>
                        <p>‚Ä¢ Choose your dashboard layout</p>
                        <p>‚Ä¢ Connect additional services</p>
                        <p>‚Ä¢ ... rest of your onboarding flow</p>
                    </div>

                    <div class="mt-6">
                        <button
                            class="bg-green-600 hover:bg-green-700 px-8 py-3 rounded-full font-bold transition-all button-glow">
                            Start Using App ‚Üí
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Loading State -->
        <div id="loadingState" class="hidden">
            <div class="free-border rounded-xl p-8 text-center">
                <div
                    class="animate-spin w-8 h-8 border-4 border-green-500 border-t-transparent rounded-full mx-auto mb-4">
                </div>
                <p class="text-gray-300">Checking liberation status...</p>
            </div>
        </div>

        <!-- Footer -->
        <div class="text-center mt-12 text-sm text-gray-500">
            <p>Powered by <a href="https://freemyx.com" target="_blank" class="text-green-400 hover:text-green-300">Free
                    My X</a></p>
            <p class="mt-2">Respecting user data liberation choices since 2024</p>
        </div>
    </div>

    <script>
        let currentUsername = '';

        async function checkLiberation() {
            const username = document.getElementById('username').value.trim();

            if (!username) {
                alert('Please enter a username');
                return;
            }

            currentUsername = username;
            showLoading();

            try {
                const response = await fetch(`https://freemyx.com/${username}`);

                if (response.ok) {
                    const userData = await response.json();

                    // Check if user has at least "me" access (choice "2") or public (choice "1")
                    const hasRequiredAccess = userData.me === true;

                    if (hasRequiredAccess) {
                        showLiberatedStatus(userData);
                    } else {
                        showNotLiberatedStatus('User has liberated data but hasn\'t granted "Me" access level');
                    }
                } else if (response.status === 404) {
                    showUserNotFound();
                } else if (response.status === 403) {
                    showNotLiberatedStatus('User has not authorized data liberation');
                } else {
                    throw new Error(`HTTP ${response.status}`);
                }
            } catch (error) {
                console.error('Liberation check error:', error);
                showUserNotFound();
            }
        }

        function showLoading() {
            document.getElementById('statusSection').classList.add('hidden');
            document.getElementById('onboardingSection').classList.add('hidden');
            document.getElementById('loadingState').classList.remove('hidden');
        }

        function hideLoading() {
            document.getElementById('loadingState').classList.add('hidden');
            document.getElementById('statusSection').classList.remove('hidden');
        }

        function showLiberatedStatus(userData) {
            hideLoading();

            // Hide other status divs
            document.getElementById('notLiberatedStatus').classList.add('hidden');
            document.getElementById('userNotFound').classList.add('hidden');

            // Show liberated status
            document.getElementById('liberatedStatus').classList.remove('hidden');

            // Populate user info
            const userInfo = document.getElementById('userInfo');
            userInfo.innerHTML = `
                <div class="flex items-center gap-3 mb-3">
                    <div class="w-12 h-12 bg-green-600 rounded-full flex items-center justify-center font-bold text-white">
                        ${userData.name ? userData.name.charAt(0).toUpperCase() : username.charAt(0).toUpperCase()}
                    </div>
                    <div>
                        <h4 class="font-bold text-green-300">${userData.name || username}</h4>
                        <p class="text-green-200">@${userData.username}</p>
                    </div>
                </div>
                <div class="text-sm text-green-200">
                    <p><strong>Access Levels:</strong></p>
                    <ul class="mt-1 space-y-1">
                        ${userData.public ? '<li>‚Ä¢ ‚úÖ Public Domain</li>' : ''}
                        ${userData.me ? '<li>‚Ä¢ ‚úÖ Me (Personal Access)</li>' : ''}
                        ${userData.follows ? '<li>‚Ä¢ ‚úÖ People I Follow</li>' : ''}
                        ${userData.science ? '<li>‚Ä¢ ‚úÖ Science & Research</li>' : ''}
                    </ul>
                </div>
            `;
        }

        function showNotLiberatedStatus(message = '') {
            hideLoading();

            // Hide other status divs
            document.getElementById('liberatedStatus').classList.add('hidden');
            document.getElementById('userNotFound').classList.add('hidden');

            // Show not liberated status
            document.getElementById('notLiberatedStatus').classList.remove('hidden');
        }

        function showUserNotFound() {
            hideLoading();

            // Hide other status divs
            document.getElementById('liberatedStatus').classList.add('hidden');
            document.getElementById('notLiberatedStatus').classList.add('hidden');

            // Show user not found
            document.getElementById('userNotFound').classList.remove('hidden');
        }

        function recheckStatus() {
            if (currentUsername) {
                checkLiberation();
            }
        }

        function resetForm() {
            document.getElementById('username').value = '';
            document.getElementById('statusSection').classList.add('hidden');
            document.getElementById('onboardingSection').classList.add('hidden');
            document.getElementById('loadingState').classList.add('hidden');
            currentUsername = '';
        }

        function proceedToNextStep() {
            document.getElementById('onboardingSection').classList.remove('hidden');
            document.getElementById('onboardingSection').scrollIntoView({ behavior: 'smooth' });
        }

        // Allow Enter key to trigger check
        document.getElementById('username').addEventListener('keypress', function (e) {
            if (e.key === 'Enter') {
                checkLiberation();
            }
        });

        // Auto-recheck when page gains focus (user returns from freemyx.com)
        window.addEventListener('focus', function () {
            if (currentUsername && !document.getElementById('liberatedStatus').classList.contains('hidden') === false) {
                setTimeout(() => {
                    recheckStatus();
                }, 1000); // Small delay to ensure user has completed action
            }
        });
    </script>
</body>

</html>